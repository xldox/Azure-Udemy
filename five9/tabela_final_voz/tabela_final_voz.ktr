<?xml version="1.0" encoding="UTF-8"?>
<transformation>
  <info>
    <name>Tabela final voz</name>
    <description/>
    <extended_description/>
    <trans_version/>
    <trans_type>Normal</trans_type>
    <trans_status>0</trans_status>
    <directory>/</directory>
    <parameters>
    </parameters>
    <log>
      <trans-log-table>
        <connection/>
        <schema/>
        <table/>
        <size_limit_lines/>
        <interval/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STATUS</id>
          <enabled>Y</enabled>
          <name>STATUS</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
          <subject/>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
          <subject/>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
          <subject/>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
          <subject/>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
          <subject/>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
          <subject/>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>STARTDATE</id>
          <enabled>Y</enabled>
          <name>STARTDATE</name>
        </field>
        <field>
          <id>ENDDATE</id>
          <enabled>Y</enabled>
          <name>ENDDATE</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>DEPDATE</id>
          <enabled>Y</enabled>
          <name>DEPDATE</name>
        </field>
        <field>
          <id>REPLAYDATE</id>
          <enabled>Y</enabled>
          <name>REPLAYDATE</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>Y</enabled>
          <name>LOG_FIELD</name>
        </field>
        <field>
          <id>EXECUTING_SERVER</id>
          <enabled>N</enabled>
          <name>EXECUTING_SERVER</name>
        </field>
        <field>
          <id>EXECUTING_USER</id>
          <enabled>N</enabled>
          <name>EXECUTING_USER</name>
        </field>
        <field>
          <id>CLIENT</id>
          <enabled>N</enabled>
          <name>CLIENT</name>
        </field>
      </trans-log-table>
      <perf-log-table>
        <connection/>
        <schema/>
        <table/>
        <interval/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>SEQ_NR</id>
          <enabled>Y</enabled>
          <name>SEQ_NR</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STEPNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>STEP_COPY</id>
          <enabled>Y</enabled>
          <name>STEP_COPY</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>INPUT_BUFFER_ROWS</id>
          <enabled>Y</enabled>
          <name>INPUT_BUFFER_ROWS</name>
        </field>
        <field>
          <id>OUTPUT_BUFFER_ROWS</id>
          <enabled>Y</enabled>
          <name>OUTPUT_BUFFER_ROWS</name>
        </field>
      </perf-log-table>
      <channel-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>LOGGING_OBJECT_TYPE</id>
          <enabled>Y</enabled>
          <name>LOGGING_OBJECT_TYPE</name>
        </field>
        <field>
          <id>OBJECT_NAME</id>
          <enabled>Y</enabled>
          <name>OBJECT_NAME</name>
        </field>
        <field>
          <id>OBJECT_COPY</id>
          <enabled>Y</enabled>
          <name>OBJECT_COPY</name>
        </field>
        <field>
          <id>REPOSITORY_DIRECTORY</id>
          <enabled>Y</enabled>
          <name>REPOSITORY_DIRECTORY</name>
        </field>
        <field>
          <id>FILENAME</id>
          <enabled>Y</enabled>
          <name>FILENAME</name>
        </field>
        <field>
          <id>OBJECT_ID</id>
          <enabled>Y</enabled>
          <name>OBJECT_ID</name>
        </field>
        <field>
          <id>OBJECT_REVISION</id>
          <enabled>Y</enabled>
          <name>OBJECT_REVISION</name>
        </field>
        <field>
          <id>PARENT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>PARENT_CHANNEL_ID</name>
        </field>
        <field>
          <id>ROOT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>ROOT_CHANNEL_ID</name>
        </field>
      </channel-log-table>
      <step-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STEPNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>STEP_COPY</id>
          <enabled>Y</enabled>
          <name>STEP_COPY</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>N</enabled>
          <name>LOG_FIELD</name>
        </field>
      </step-log-table>
      <metrics-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>METRICS_DATE</id>
          <enabled>Y</enabled>
          <name>METRICS_DATE</name>
        </field>
        <field>
          <id>METRICS_CODE</id>
          <enabled>Y</enabled>
          <name>METRICS_CODE</name>
        </field>
        <field>
          <id>METRICS_DESCRIPTION</id>
          <enabled>Y</enabled>
          <name>METRICS_DESCRIPTION</name>
        </field>
        <field>
          <id>METRICS_SUBJECT</id>
          <enabled>Y</enabled>
          <name>METRICS_SUBJECT</name>
        </field>
        <field>
          <id>METRICS_TYPE</id>
          <enabled>Y</enabled>
          <name>METRICS_TYPE</name>
        </field>
        <field>
          <id>METRICS_VALUE</id>
          <enabled>Y</enabled>
          <name>METRICS_VALUE</name>
        </field>
      </metrics-log-table>
    </log>
    <maxdate>
      <connection/>
      <table/>
      <field/>
      <offset>0.0</offset>
      <maxdiff>0.0</maxdiff>
    </maxdate>
    <size_rowset>10000</size_rowset>
    <sleep_time_empty>50</sleep_time_empty>
    <sleep_time_full>50</sleep_time_full>
    <unique_connections>N</unique_connections>
    <feedback_shown>Y</feedback_shown>
    <feedback_size>50000</feedback_size>
    <using_thread_priorities>Y</using_thread_priorities>
    <shared_objects_file/>
    <capture_step_performance>N</capture_step_performance>
    <step_performance_capturing_delay>1000</step_performance_capturing_delay>
    <step_performance_capturing_size_limit>100</step_performance_capturing_size_limit>
    <dependencies>
    </dependencies>
    <partitionschemas>
    </partitionschemas>
    <slaveservers>
    </slaveservers>
    <clusterschemas>
    </clusterschemas>
    <created_user>-</created_user>
    <created_date>2023/06/09 18:18:36.813</created_date>
    <modified_user>-</modified_user>
    <modified_date>2023/06/09 18:18:36.813</modified_date>
    <key_for_session_key>H4sIAAAAAAAAAAMAAAAAAAAAAAA=</key_for_session_key>
    <is_key_private>N</is_key_private>
  </info>
  <notepads>
  </notepads>
  <connection>
    <name>MOB (ODS)</name>
    <server>${ODS_SQLSERVER_host}</server>
    <type>MSSQLNATIVE</type>
    <access>Native</access>
    <database>MOB</database>
    <port>1433</port>
    <username>${sqlserver_ods_SQLSERVER_username}</username>
    <password>${sqlserver_ods_SQLSERVER_password}</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>MSSQLUseIntegratedSecurity</code>
        <attribute>false</attribute>
      </attribute>
      <attribute>
        <code>MSSQL_DOUBLE_DECIMAL_SEPARATOR</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>1433</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <connection>
    <name>STAGE</name>
    <server>${DataMart_BI_SQLSERVER_host}</server>
    <type>MSSQLNATIVE</type>
    <access>Native</access>
    <database>STAGE</database>
    <port>1433</port>
    <username>${sqlserver_datamart_BI_SQLSERVER_username}</username>
    <password>${sqlserver_datamart_BI_SQLSERVER_password}</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>MSSQLUseIntegratedSecurity</code>
        <attribute>false</attribute>
      </attribute>
      <attribute>
        <code>MSSQL_DOUBLE_DECIMAL_SEPARATOR</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>1433</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <connection>
    <name>SUMICITY (ODS)</name>
    <server>${ODS_SQLSERVER_host}</server>
    <type>MSSQLNATIVE</type>
    <access>Native</access>
    <database>SUMICITY</database>
    <port>1433</port>
    <username>${sqlserver_ods_SQLSERVER_username}</username>
    <password>${sqlserver_ods_SQLSERVER_password}</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>MSSQLUseIntegratedSecurity</code>
        <attribute>false</attribute>
      </attribute>
      <attribute>
        <code>MSSQL_DOUBLE_DECIMAL_SEPARATOR</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>1433</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <connection>
    <name>VIP (ODS)</name>
    <server>${ODS_SQLSERVER_host}</server>
    <type>MSSQLNATIVE</type>
    <access>Native</access>
    <database>VIP</database>
    <port>1433</port>
    <username>${sqlserver_ods_SQLSERVER_username}</username>
    <password>${sqlserver_ods_SQLSERVER_password}</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>MSSQLUseIntegratedSecurity</code>
        <attribute>false</attribute>
      </attribute>
      <attribute>
        <code>MSSQL_DOUBLE_DECIMAL_SEPARATOR</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>1433</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <order>
    <hop>
      <from>Polo SUMICITY</from>
      <to>Polo VIP</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Polo SUMICITY</from>
      <to>Registros SUMICITY</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Polo VIP</from>
      <to>Registros MOB</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Polo VIP</from>
      <to>Registros VIP</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Registros MOB</from>
      <to>TMA (MOB)</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Registros SUMICITY</from>
      <to>TMA (Sumicity)</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Registros VIP</from>
      <to>TMA (VIP)</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Sort rows</from>
      <to>Polo SUMICITY</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Chamadas Recebidas Voz</from>
      <to>Select values</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Select values</from>
      <to>Sort rows</to>
      <enabled>Y</enabled>
    </hop>
  </order>
  <step>
    <name>Chamadas Recebidas Voz</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>STAGE</connection>
    <sql>-- criando uma chave para os registros
SELECT DISTINCT
		CAST(id_ligacao AS VARCHAR) + '_' + CAST(data_ligacao AS VARCHAR) AS chave
		,* INTO #aux_stg_tma 
		
FROM STAGE.five9.stg_tma order by id_ligacao asc,data_ligacao asc




--separando linhas de transferência
SELECT DISTINCT id_ligacao,data_ligacao,CAST(id_ligacao AS VARCHAR) + '_' + CAST(data_ligacao AS VARCHAR) AS chave  
INTO #transferido 
FROM
(
	SELECT
		id_ligacao
		 , data_ligacao
		 , campanha
		 , competencia
		 , ani
		 , dnis
		 , segmento
		 , id_segmento
		 , chamador
		 , resultado
		 , tempo_segmento
		 , tipo_segmento
		 , posicao
		 , tempo_fila
		 , tempo_conversa
		 , tempo_ligacao
		 , tipo_ligacao
		 , transferencias
		 , marca
		 , data_extracao
		 , CASE
			 WHEN marca IN ('VIP', 'LIGUE', 'NIU') THEN 'VIP'
			 WHEN marca IN ('SUMICITY', 'GIGA+ FIBRA', 'CLICK', 'UNIVOX') THEN 'SUMICITY'
			 WHEN marca IN ('MOB', 'WIRELINK') THEN 'MOB'
			 ELSE '-'
		   END polos

	FROM #aux_stg_tma
) A
WHERE tipo_segmento = 'Transferência de competência'
order by id_ligacao asc, data_ligacao asc
;




-- separando linhas de recebimento
SELECT DISTINCT id_ligacao,data_ligacao,CAST(id_ligacao AS VARCHAR) + '_' + CAST(data_ligacao AS VARCHAR) AS chave 
INTO #recebido 
FROM
(
	SELECT
		id_ligacao
		 , data_ligacao
		 , campanha
		 , competencia
		 , ani
		 , dnis
		 , segmento
		 , id_segmento
		 , chamador
		 , resultado
		 , tempo_segmento
		 , tipo_segmento
		 , posicao
		 , tempo_fila
		 , tempo_conversa
		 , tempo_ligacao
		 , tipo_ligacao
		 , transferencias
		 , marca
		 , data_extracao
		 , CASE
			 WHEN marca IN ('VIP', 'LIGUE', 'NIU') THEN 'VIP'
			 WHEN marca IN ('SUMICITY', 'GIGA+ FIBRA', 'CLICK', 'UNIVOX') THEN 'SUMICITY'
			 WHEN marca IN ('MOB', 'WIRELINK') THEN 'MOB'
			 ELSE '-'
		   END polos

	FROM #aux_stg_tma
) A
WHERE tipo_segmento = 'Transferir para competência'
ORDER BY id_ligacao asc, data_ligacao asc
;



-- separando linhas de transferencia e pegando dados de linhas anteriores
SELECT 
	DISTINCT
			STAGE.id_ligacao
			--,STAGE.data_ligacao
			,CASE 
				WHEN LAG(STAGE.id_ligacao) OVER (PARTITION BY STAGE.id_ligacao ORDER BY STAGE.data_ligacao ASC) = STAGE.id_ligacao AND STAGE.tipo_segmento = 'Transferir para competência' THEN LAG(STAGE.data_ligacao) OVER (PARTITION BY STAGE.id_ligacao  ORDER BY STAGE.data_ligacao ASC)  
				ELSE NULL
			END AS hora_chamada
			,CASE WHEN STAGE.tipo_segmento = 'Transferir para competência' THEN STAGE.data_ligacao ELSE NULL END AS hora_atendimento
			,CASE 
				WHEN LAG(STAGE.id_ligacao) OVER (PARTITION BY STAGE.id_ligacao ORDER BY STAGE.data_ligacao ASC) = STAGE.id_ligacao AND STAGE.tipo_segmento = 'Transferir para competência' THEN LAG(STAGE.segmento) OVER (PARTITION BY STAGE.id_ligacao  ORDER BY STAGE.data_ligacao ASC)  
				ELSE NULL
			END AS campanha
			
			--,CASE WHEN LAG(STAGE.id_ligacao) OVER (PARTITION BY STAGE.id_ligacao ORDER BY STAGE.data_ligacao ASC) = STAGE.id_ligacao AND LAG(STAGE.data_ligacao) OVER (PARTITION BY STAGE.id_ligacao  ORDER BY STAGE.data_ligacao ASC) &lt; STAGE.data_ligacao THEN LAG(segmento) OVER (PARTITION BY STAGE.id_ligacao  ORDER BY STAGE.data_ligacao ASC) ELSE NULL END AS campanha
			,segmento
			--,tempo_ligacao
			,tipo_segmento
			,tempo_conversa
			
INTO #aux_stg_tma2
FROM #aux_stg_tma STAGE
		LEFT JOIN #transferido TR ON STAGE.chave = TR.chave
		LEFT JOIN #recebido RE ON RE.chave = STAGE.chave

WHERE tipo_segmento IN ('Transferir para competência','Transferência de competência')
ORDER BY id_ligacao









--criando indice das transferencias
SELECT DISTINCT ROW_NUMBER() OVER (PARTITION BY A.id_ligacao ORDER BY A.hora_atendimento) AS indice
	,A.id_ligacao
	,hora_atendimento
	,hora_chamada
	,format(dateadd(ss,DATEDIFF(SECOND,hora_chamada,hora_atendimento),0),'HH:mm:ss') AS tempo_chamando
	,tempo_conversa
	,campanha AS competencia
	,CASE WHEN LEAD(A.id_ligacao) OVER (PARTITION BY A.id_ligacao ORDER BY A.hora_atendimento ASC) = A.id_ligacao  THEN LEAD(A.campanha) OVER (PARTITION BY A.id_ligacao  ORDER BY A.hora_atendimento ASC) END AS prox_competencia
	,segmento AS email_agente
	,tipo_segmento
	,B.desligamento
INTO #aux_stg_tma3

FROM
#aux_stg_tma2 A
LEFT JOIN (SELECT id_ligacao,MIN(data_ligacao) atendimento,MAX(data_ligacao) desligamento FROM #aux_stg_tma GROUP BY id_ligacao) B ON A.id_ligacao = B.id_ligacao
WHERE tipo_segmento = 'Transferir para competência'



-- tabela final
SELECT DISTINCT
	V.id_ligacao
	,hora_chamada AS data_inicial_chamada
	,hora_atendimento AS data_atendimento
	,T.competencia AS servico
	,prox_competencia AS destino_transferencia
	,T.email_agente AS agente
	,CASE 
		WHEN indice = indice_max THEN V.posicao 
		ELSE 'Chamada transferida' 
	END AS resultado
	,T.tempo_conversa
	,cpf_cnpj
	,contrato
	,V.campanha
	,V.ani AS origem
	,V.dnis AS destino
	,V.massiva
	,V.endereco
	,V.cidade
	,V.bairro
	,V.pergunta_1
	,V.pergunta_2
	,V.pergunta_3
	,V.marca
	, 'Voz' AS midia
	,'Entrante' AS tipo 
	,'SUMICITY' AS polos
FROM STAGE.five9.stg_chamadas_recebidas_voz V

INNER JOIN (SELECT * FROM #aux_stg_tma3 WHERE tipo_segmento = 'Transferir para competência') T ON T.id_ligacao = V.id_ligacao
INNER JOIN (SELECT MAX(indice) AS indice_max,id_ligacao FROM #aux_stg_tma3 GROUP BY id_ligacao) T2 ON T2.id_ligacao = T.id_ligacao
WHERE marca IN ('SUMICITY', 'GIGA+ FIBRA', 'CLICK', 'UNIVOX') AND V.id_ligacao NOT IN (SELECT DISTINCT id_ligacao FROM STAGE.five9.auxiliar_id_ligacao WHERE tabela = 'recebidas voz' AND polos = 'SUMICITY')



UNION




-- tabela final
SELECT DISTINCT
	V.id_ligacao
	,hora_chamada AS data_inicial_chamada
	,hora_atendimento AS data_atendimento
	,T.competencia AS servico
	,prox_competencia AS destino_transferencia
	,T.email_agente AS agente
	,CASE 
		WHEN indice = indice_max THEN V.posicao 
		ELSE 'Chamada transferida' 
	END AS resultado
	,T.tempo_conversa
	,cpf_cnpj
	,contrato
	,V.campanha
	,V.ani AS origem
	,V.dnis AS destino
	,V.massiva
	,V.endereco
	,V.cidade
	,V.bairro
	,V.pergunta_1
	,V.pergunta_2
	,V.pergunta_3
	,V.marca
	, 'Voz' AS midia
	,'Entrante' AS tipo 
	,'VIP' AS polos
FROM STAGE.five9.stg_chamadas_recebidas_voz V

INNER JOIN (SELECT * FROM #aux_stg_tma3 WHERE tipo_segmento = 'Transferir para competência') T ON T.id_ligacao = V.id_ligacao
INNER JOIN (SELECT MAX(indice) AS indice_max,id_ligacao FROM #aux_stg_tma3 GROUP BY id_ligacao) T2 ON T2.id_ligacao = T.id_ligacao
WHERE marca IN ('VIP', 'LIGUE', 'NIU') AND V.id_ligacao NOT IN (SELECT DISTINCT id_ligacao FROM STAGE.five9.auxiliar_id_ligacao WHERE tabela = 'recebidas voz' AND polos = 'VIP')




UNION




-- tabela final
SELECT DISTINCT
	V.id_ligacao
	,hora_chamada AS data_inicial_chamada
	,hora_atendimento AS data_atendimento
	,T.competencia AS servico
	,prox_competencia AS destino_transferencia
	,T.email_agente AS agente
	,CASE 
		WHEN indice = indice_max THEN V.posicao 
		ELSE 'Chamada transferida' 
	END AS resultado
	,T.tempo_conversa
	,cpf_cnpj
	,contrato
	,V.campanha
	,V.ani AS origem
	,V.dnis AS destino
	,V.massiva
	,V.endereco
	,V.cidade
	,V.bairro
	,V.pergunta_1
	,V.pergunta_2
	,V.pergunta_3
	,V.marca
	, 'Voz' AS midia
	,'Entrante' AS tipo 
	,'MOB' AS polos
FROM STAGE.five9.stg_chamadas_recebidas_voz V

INNER JOIN (SELECT * FROM #aux_stg_tma3 WHERE tipo_segmento = 'Transferir para competência') T ON T.id_ligacao = V.id_ligacao
INNER JOIN (SELECT MAX(indice) AS indice_max,id_ligacao FROM #aux_stg_tma3 GROUP BY id_ligacao) T2 ON T2.id_ligacao = T.id_ligacao
WHERE marca IN ('MOB', 'WIRELINK') AND V.id_ligacao NOT IN (SELECT DISTINCT id_ligacao FROM STAGE.five9.auxiliar_id_ligacao WHERE tabela = 'recebidas voz' AND polos = 'MOB')






DROP TABLE #transferido
DROP TABLE #recebido
DROP TABLE #aux_stg_tma
DROP TABLE #aux_stg_tma2
DROP TABLE #aux_stg_tma3</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cached_row_meta_active>N</cached_row_meta_active>
    <row-meta>
      <value-meta>
        <type>String</type>
        <storagetype>normal</storagetype>
        <name>id_ligacao</name>
        <length>500</length>
        <precision>-1</precision>
        <origin>Chamadas Recebidas Voz</origin>
        <comments>id_ligacao</comments>
        <conversion_Mask/>
        <decimal_symbol>,</decimal_symbol>
        <grouping_symbol>.</grouping_symbol>
        <currency_symbol/>
        <trim_type>none</trim_type>
        <case_insensitive>N</case_insensitive>
        <collator_disabled>Y</collator_disabled>
        <collator_strength>0</collator_strength>
        <sort_descending>N</sort_descending>
        <output_padding>N</output_padding>
        <date_format_lenient>N</date_format_lenient>
        <date_format_locale>pt_BR</date_format_locale>
        <date_format_timezone>America/Sao_Paulo</date_format_timezone>
        <lenient_string_to_number>N</lenient_string_to_number>
      </value-meta>
      <value-meta>
        <type>String</type>
        <storagetype>normal</storagetype>
        <name>data_inicial_chamada</name>
        <length>500</length>
        <precision>-1</precision>
        <origin>Chamadas Recebidas Voz</origin>
        <comments>data_inicial_chamada</comments>
        <conversion_Mask/>
        <decimal_symbol>,</decimal_symbol>
        <grouping_symbol>.</grouping_symbol>
        <currency_symbol/>
        <trim_type>none</trim_type>
        <case_insensitive>N</case_insensitive>
        <collator_disabled>Y</collator_disabled>
        <collator_strength>0</collator_strength>
        <sort_descending>N</sort_descending>
        <output_padding>N</output_padding>
        <date_format_lenient>N</date_format_lenient>
        <date_format_locale>pt_BR</date_format_locale>
        <date_format_timezone>America/Sao_Paulo</date_format_timezone>
        <lenient_string_to_number>N</lenient_string_to_number>
      </value-meta>
      <value-meta>
        <type>String</type>
        <storagetype>normal</storagetype>
        <name>data_atendimento</name>
        <length>500</length>
        <precision>-1</precision>
        <origin>Chamadas Recebidas Voz</origin>
        <comments>data_atendimento</comments>
        <conversion_Mask/>
        <decimal_symbol>,</decimal_symbol>
        <grouping_symbol>.</grouping_symbol>
        <currency_symbol/>
        <trim_type>none</trim_type>
        <case_insensitive>N</case_insensitive>
        <collator_disabled>Y</collator_disabled>
        <collator_strength>0</collator_strength>
        <sort_descending>N</sort_descending>
        <output_padding>N</output_padding>
        <date_format_lenient>N</date_format_lenient>
        <date_format_locale>pt_BR</date_format_locale>
        <date_format_timezone>America/Sao_Paulo</date_format_timezone>
        <lenient_string_to_number>N</lenient_string_to_number>
      </value-meta>
      <value-meta>
        <type>String</type>
        <storagetype>normal</storagetype>
        <name>servico</name>
        <length>500</length>
        <precision>-1</precision>
        <origin>Chamadas Recebidas Voz</origin>
        <comments>servico</comments>
        <conversion_Mask/>
        <decimal_symbol>,</decimal_symbol>
        <grouping_symbol>.</grouping_symbol>
        <currency_symbol/>
        <trim_type>none</trim_type>
        <case_insensitive>N</case_insensitive>
        <collator_disabled>Y</collator_disabled>
        <collator_strength>0</collator_strength>
        <sort_descending>N</sort_descending>
        <output_padding>N</output_padding>
        <date_format_lenient>N</date_format_lenient>
        <date_format_locale>pt_BR</date_format_locale>
        <date_format_timezone>America/Sao_Paulo</date_format_timezone>
        <lenient_string_to_number>N</lenient_string_to_number>
      </value-meta>
      <value-meta>
        <type>String</type>
        <storagetype>normal</storagetype>
        <name>destino_transferencia</name>
        <length>500</length>
        <precision>-1</precision>
        <origin>Chamadas Recebidas Voz</origin>
        <comments>destino_transferencia</comments>
        <conversion_Mask/>
        <decimal_symbol>,</decimal_symbol>
        <grouping_symbol>.</grouping_symbol>
        <currency_symbol/>
        <trim_type>none</trim_type>
        <case_insensitive>N</case_insensitive>
        <collator_disabled>Y</collator_disabled>
        <collator_strength>0</collator_strength>
        <sort_descending>N</sort_descending>
        <output_padding>N</output_padding>
        <date_format_lenient>N</date_format_lenient>
        <date_format_locale>pt_BR</date_format_locale>
        <date_format_timezone>America/Sao_Paulo</date_format_timezone>
        <lenient_string_to_number>N</lenient_string_to_number>
      </value-meta>
      <value-meta>
        <type>String</type>
        <storagetype>normal</storagetype>
        <name>agente</name>
        <length>500</length>
        <precision>-1</precision>
        <origin>Chamadas Recebidas Voz</origin>
        <comments>agente</comments>
        <conversion_Mask/>
        <decimal_symbol>,</decimal_symbol>
        <grouping_symbol>.</grouping_symbol>
        <currency_symbol/>
        <trim_type>none</trim_type>
        <case_insensitive>N</case_insensitive>
        <collator_disabled>Y</collator_disabled>
        <collator_strength>0</collator_strength>
        <sort_descending>N</sort_descending>
        <output_padding>N</output_padding>
        <date_format_lenient>N</date_format_lenient>
        <date_format_locale>pt_BR</date_format_locale>
        <date_format_timezone>America/Sao_Paulo</date_format_timezone>
        <lenient_string_to_number>N</lenient_string_to_number>
      </value-meta>
      <value-meta>
        <type>String</type>
        <storagetype>normal</storagetype>
        <name>resultado</name>
        <length>500</length>
        <precision>-1</precision>
        <origin>Chamadas Recebidas Voz</origin>
        <comments>resultado</comments>
        <conversion_Mask/>
        <decimal_symbol>,</decimal_symbol>
        <grouping_symbol>.</grouping_symbol>
        <currency_symbol/>
        <trim_type>none</trim_type>
        <case_insensitive>N</case_insensitive>
        <collator_disabled>Y</collator_disabled>
        <collator_strength>0</collator_strength>
        <sort_descending>N</sort_descending>
        <output_padding>N</output_padding>
        <date_format_lenient>N</date_format_lenient>
        <date_format_locale>pt_BR</date_format_locale>
        <date_format_timezone>America/Sao_Paulo</date_format_timezone>
        <lenient_string_to_number>N</lenient_string_to_number>
      </value-meta>
      <value-meta>
        <type>String</type>
        <storagetype>normal</storagetype>
        <name>tempo_conversa</name>
        <length>500</length>
        <precision>-1</precision>
        <origin>Chamadas Recebidas Voz</origin>
        <comments>tempo_conversa</comments>
        <conversion_Mask/>
        <decimal_symbol>,</decimal_symbol>
        <grouping_symbol>.</grouping_symbol>
        <currency_symbol/>
        <trim_type>none</trim_type>
        <case_insensitive>N</case_insensitive>
        <collator_disabled>Y</collator_disabled>
        <collator_strength>0</collator_strength>
        <sort_descending>N</sort_descending>
        <output_padding>N</output_padding>
        <date_format_lenient>N</date_format_lenient>
        <date_format_locale>pt_BR</date_format_locale>
        <date_format_timezone>America/Sao_Paulo</date_format_timezone>
        <lenient_string_to_number>N</lenient_string_to_number>
      </value-meta>
      <value-meta>
        <type>String</type>
        <storagetype>normal</storagetype>
        <name>cpf_cnpj</name>
        <length>500</length>
        <precision>-1</precision>
        <origin>Chamadas Recebidas Voz</origin>
        <comments>cpf_cnpj</comments>
        <conversion_Mask/>
        <decimal_symbol>,</decimal_symbol>
        <grouping_symbol>.</grouping_symbol>
        <currency_symbol/>
        <trim_type>none</trim_type>
        <case_insensitive>N</case_insensitive>
        <collator_disabled>Y</collator_disabled>
        <collator_strength>0</collator_strength>
        <sort_descending>N</sort_descending>
        <output_padding>N</output_padding>
        <date_format_lenient>N</date_format_lenient>
        <date_format_locale>pt_BR</date_format_locale>
        <date_format_timezone>America/Sao_Paulo</date_format_timezone>
        <lenient_string_to_number>N</lenient_string_to_number>
      </value-meta>
      <value-meta>
        <type>String</type>
        <storagetype>normal</storagetype>
        <name>contrato</name>
        <length>500</length>
        <precision>-1</precision>
        <origin>Chamadas Recebidas Voz</origin>
        <comments>contrato</comments>
        <conversion_Mask/>
        <decimal_symbol>,</decimal_symbol>
        <grouping_symbol>.</grouping_symbol>
        <currency_symbol/>
        <trim_type>none</trim_type>
        <case_insensitive>N</case_insensitive>
        <collator_disabled>Y</collator_disabled>
        <collator_strength>0</collator_strength>
        <sort_descending>N</sort_descending>
        <output_padding>N</output_padding>
        <date_format_lenient>N</date_format_lenient>
        <date_format_locale>pt_BR</date_format_locale>
        <date_format_timezone>America/Sao_Paulo</date_format_timezone>
        <lenient_string_to_number>N</lenient_string_to_number>
      </value-meta>
      <value-meta>
        <type>String</type>
        <storagetype>normal</storagetype>
        <name>campanha</name>
        <length>500</length>
        <precision>-1</precision>
        <origin>Chamadas Recebidas Voz</origin>
        <comments>campanha</comments>
        <conversion_Mask/>
        <decimal_symbol>,</decimal_symbol>
        <grouping_symbol>.</grouping_symbol>
        <currency_symbol/>
        <trim_type>none</trim_type>
        <case_insensitive>N</case_insensitive>
        <collator_disabled>Y</collator_disabled>
        <collator_strength>0</collator_strength>
        <sort_descending>N</sort_descending>
        <output_padding>N</output_padding>
        <date_format_lenient>N</date_format_lenient>
        <date_format_locale>pt_BR</date_format_locale>
        <date_format_timezone>America/Sao_Paulo</date_format_timezone>
        <lenient_string_to_number>N</lenient_string_to_number>
      </value-meta>
      <value-meta>
        <type>String</type>
        <storagetype>normal</storagetype>
        <name>origem</name>
        <length>500</length>
        <precision>-1</precision>
        <origin>Chamadas Recebidas Voz</origin>
        <comments>origem</comments>
        <conversion_Mask/>
        <decimal_symbol>,</decimal_symbol>
        <grouping_symbol>.</grouping_symbol>
        <currency_symbol/>
        <trim_type>none</trim_type>
        <case_insensitive>N</case_insensitive>
        <collator_disabled>Y</collator_disabled>
        <collator_strength>0</collator_strength>
        <sort_descending>N</sort_descending>
        <output_padding>N</output_padding>
        <date_format_lenient>N</date_format_lenient>
        <date_format_locale>pt_BR</date_format_locale>
        <date_format_timezone>America/Sao_Paulo</date_format_timezone>
        <lenient_string_to_number>N</lenient_string_to_number>
      </value-meta>
      <value-meta>
        <type>String</type>
        <storagetype>normal</storagetype>
        <name>destino</name>
        <length>500</length>
        <precision>-1</precision>
        <origin>Chamadas Recebidas Voz</origin>
        <comments>destino</comments>
        <conversion_Mask/>
        <decimal_symbol>,</decimal_symbol>
        <grouping_symbol>.</grouping_symbol>
        <currency_symbol/>
        <trim_type>none</trim_type>
        <case_insensitive>N</case_insensitive>
        <collator_disabled>Y</collator_disabled>
        <collator_strength>0</collator_strength>
        <sort_descending>N</sort_descending>
        <output_padding>N</output_padding>
        <date_format_lenient>N</date_format_lenient>
        <date_format_locale>pt_BR</date_format_locale>
        <date_format_timezone>America/Sao_Paulo</date_format_timezone>
        <lenient_string_to_number>N</lenient_string_to_number>
      </value-meta>
      <value-meta>
        <type>String</type>
        <storagetype>normal</storagetype>
        <name>massiva</name>
        <length>500</length>
        <precision>-1</precision>
        <origin>Chamadas Recebidas Voz</origin>
        <comments>massiva</comments>
        <conversion_Mask/>
        <decimal_symbol>,</decimal_symbol>
        <grouping_symbol>.</grouping_symbol>
        <currency_symbol/>
        <trim_type>none</trim_type>
        <case_insensitive>N</case_insensitive>
        <collator_disabled>Y</collator_disabled>
        <collator_strength>0</collator_strength>
        <sort_descending>N</sort_descending>
        <output_padding>N</output_padding>
        <date_format_lenient>N</date_format_lenient>
        <date_format_locale>pt_BR</date_format_locale>
        <date_format_timezone>America/Sao_Paulo</date_format_timezone>
        <lenient_string_to_number>N</lenient_string_to_number>
      </value-meta>
      <value-meta>
        <type>String</type>
        <storagetype>normal</storagetype>
        <name>endereco</name>
        <length>500</length>
        <precision>-1</precision>
        <origin>Chamadas Recebidas Voz</origin>
        <comments>endereco</comments>
        <conversion_Mask/>
        <decimal_symbol>,</decimal_symbol>
        <grouping_symbol>.</grouping_symbol>
        <currency_symbol/>
        <trim_type>none</trim_type>
        <case_insensitive>N</case_insensitive>
        <collator_disabled>Y</collator_disabled>
        <collator_strength>0</collator_strength>
        <sort_descending>N</sort_descending>
        <output_padding>N</output_padding>
        <date_format_lenient>N</date_format_lenient>
        <date_format_locale>pt_BR</date_format_locale>
        <date_format_timezone>America/Sao_Paulo</date_format_timezone>
        <lenient_string_to_number>N</lenient_string_to_number>
      </value-meta>
      <value-meta>
        <type>String</type>
        <storagetype>normal</storagetype>
        <name>cidade</name>
        <length>500</length>
        <precision>-1</precision>
        <origin>Chamadas Recebidas Voz</origin>
        <comments>cidade</comments>
        <conversion_Mask/>
        <decimal_symbol>,</decimal_symbol>
        <grouping_symbol>.</grouping_symbol>
        <currency_symbol/>
        <trim_type>none</trim_type>
        <case_insensitive>N</case_insensitive>
        <collator_disabled>Y</collator_disabled>
        <collator_strength>0</collator_strength>
        <sort_descending>N</sort_descending>
        <output_padding>N</output_padding>
        <date_format_lenient>N</date_format_lenient>
        <date_format_locale>pt_BR</date_format_locale>
        <date_format_timezone>America/Sao_Paulo</date_format_timezone>
        <lenient_string_to_number>N</lenient_string_to_number>
      </value-meta>
      <value-meta>
        <type>String</type>
        <storagetype>normal</storagetype>
        <name>bairro</name>
        <length>500</length>
        <precision>-1</precision>
        <origin>Chamadas Recebidas Voz</origin>
        <comments>bairro</comments>
        <conversion_Mask/>
        <decimal_symbol>,</decimal_symbol>
        <grouping_symbol>.</grouping_symbol>
        <currency_symbol/>
        <trim_type>none</trim_type>
        <case_insensitive>N</case_insensitive>
        <collator_disabled>Y</collator_disabled>
        <collator_strength>0</collator_strength>
        <sort_descending>N</sort_descending>
        <output_padding>N</output_padding>
        <date_format_lenient>N</date_format_lenient>
        <date_format_locale>pt_BR</date_format_locale>
        <date_format_timezone>America/Sao_Paulo</date_format_timezone>
        <lenient_string_to_number>N</lenient_string_to_number>
      </value-meta>
      <value-meta>
        <type>String</type>
        <storagetype>normal</storagetype>
        <name>pergunta_1</name>
        <length>500</length>
        <precision>-1</precision>
        <origin>Chamadas Recebidas Voz</origin>
        <comments>pergunta_1</comments>
        <conversion_Mask/>
        <decimal_symbol>,</decimal_symbol>
        <grouping_symbol>.</grouping_symbol>
        <currency_symbol/>
        <trim_type>none</trim_type>
        <case_insensitive>N</case_insensitive>
        <collator_disabled>Y</collator_disabled>
        <collator_strength>0</collator_strength>
        <sort_descending>N</sort_descending>
        <output_padding>N</output_padding>
        <date_format_lenient>N</date_format_lenient>
        <date_format_locale>pt_BR</date_format_locale>
        <date_format_timezone>America/Sao_Paulo</date_format_timezone>
        <lenient_string_to_number>N</lenient_string_to_number>
      </value-meta>
      <value-meta>
        <type>String</type>
        <storagetype>normal</storagetype>
        <name>pergunta_2</name>
        <length>500</length>
        <precision>-1</precision>
        <origin>Chamadas Recebidas Voz</origin>
        <comments>pergunta_2</comments>
        <conversion_Mask/>
        <decimal_symbol>,</decimal_symbol>
        <grouping_symbol>.</grouping_symbol>
        <currency_symbol/>
        <trim_type>none</trim_type>
        <case_insensitive>N</case_insensitive>
        <collator_disabled>Y</collator_disabled>
        <collator_strength>0</collator_strength>
        <sort_descending>N</sort_descending>
        <output_padding>N</output_padding>
        <date_format_lenient>N</date_format_lenient>
        <date_format_locale>pt_BR</date_format_locale>
        <date_format_timezone>America/Sao_Paulo</date_format_timezone>
        <lenient_string_to_number>N</lenient_string_to_number>
      </value-meta>
      <value-meta>
        <type>String</type>
        <storagetype>normal</storagetype>
        <name>pergunta_3</name>
        <length>500</length>
        <precision>-1</precision>
        <origin>Chamadas Recebidas Voz</origin>
        <comments>pergunta_3</comments>
        <conversion_Mask/>
        <decimal_symbol>,</decimal_symbol>
        <grouping_symbol>.</grouping_symbol>
        <currency_symbol/>
        <trim_type>none</trim_type>
        <case_insensitive>N</case_insensitive>
        <collator_disabled>Y</collator_disabled>
        <collator_strength>0</collator_strength>
        <sort_descending>N</sort_descending>
        <output_padding>N</output_padding>
        <date_format_lenient>N</date_format_lenient>
        <date_format_locale>pt_BR</date_format_locale>
        <date_format_timezone>America/Sao_Paulo</date_format_timezone>
        <lenient_string_to_number>N</lenient_string_to_number>
      </value-meta>
      <value-meta>
        <type>String</type>
        <storagetype>normal</storagetype>
        <name>marca</name>
        <length>500</length>
        <precision>-1</precision>
        <origin>Chamadas Recebidas Voz</origin>
        <comments>marca</comments>
        <conversion_Mask/>
        <decimal_symbol>,</decimal_symbol>
        <grouping_symbol>.</grouping_symbol>
        <currency_symbol/>
        <trim_type>none</trim_type>
        <case_insensitive>N</case_insensitive>
        <collator_disabled>Y</collator_disabled>
        <collator_strength>0</collator_strength>
        <sort_descending>N</sort_descending>
        <output_padding>N</output_padding>
        <date_format_lenient>N</date_format_lenient>
        <date_format_locale>pt_BR</date_format_locale>
        <date_format_timezone>America/Sao_Paulo</date_format_timezone>
        <lenient_string_to_number>N</lenient_string_to_number>
      </value-meta>
      <value-meta>
        <type>String</type>
        <storagetype>normal</storagetype>
        <name>midia</name>
        <length>3</length>
        <precision>-1</precision>
        <origin>Chamadas Recebidas Voz</origin>
        <comments>midia</comments>
        <conversion_Mask/>
        <decimal_symbol>,</decimal_symbol>
        <grouping_symbol>.</grouping_symbol>
        <currency_symbol/>
        <trim_type>none</trim_type>
        <case_insensitive>N</case_insensitive>
        <collator_disabled>Y</collator_disabled>
        <collator_strength>0</collator_strength>
        <sort_descending>N</sort_descending>
        <output_padding>N</output_padding>
        <date_format_lenient>N</date_format_lenient>
        <date_format_locale>pt_BR</date_format_locale>
        <date_format_timezone>America/Sao_Paulo</date_format_timezone>
        <lenient_string_to_number>N</lenient_string_to_number>
      </value-meta>
      <value-meta>
        <type>String</type>
        <storagetype>normal</storagetype>
        <name>tipo</name>
        <length>8</length>
        <precision>-1</precision>
        <origin>Chamadas Recebidas Voz</origin>
        <comments>tipo</comments>
        <conversion_Mask/>
        <decimal_symbol>,</decimal_symbol>
        <grouping_symbol>.</grouping_symbol>
        <currency_symbol/>
        <trim_type>none</trim_type>
        <case_insensitive>N</case_insensitive>
        <collator_disabled>Y</collator_disabled>
        <collator_strength>0</collator_strength>
        <sort_descending>N</sort_descending>
        <output_padding>N</output_padding>
        <date_format_lenient>N</date_format_lenient>
        <date_format_locale>pt_BR</date_format_locale>
        <date_format_timezone>America/Sao_Paulo</date_format_timezone>
        <lenient_string_to_number>N</lenient_string_to_number>
      </value-meta>
      <value-meta>
        <type>String</type>
        <storagetype>normal</storagetype>
        <name>polos</name>
        <length>8</length>
        <precision>-1</precision>
        <origin>Chamadas Recebidas Voz</origin>
        <comments>polos</comments>
        <conversion_Mask/>
        <decimal_symbol>,</decimal_symbol>
        <grouping_symbol>.</grouping_symbol>
        <currency_symbol/>
        <trim_type>none</trim_type>
        <case_insensitive>N</case_insensitive>
        <collator_disabled>Y</collator_disabled>
        <collator_strength>0</collator_strength>
        <sort_descending>N</sort_descending>
        <output_padding>N</output_padding>
        <date_format_lenient>N</date_format_lenient>
        <date_format_locale>pt_BR</date_format_locale>
        <date_format_timezone>America/Sao_Paulo</date_format_timezone>
        <lenient_string_to_number>N</lenient_string_to_number>
      </value-meta>
    </row-meta>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>128</xloc>
      <yloc>144</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Polo SUMICITY</name>
    <type>FilterRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <send_true_to>Registros SUMICITY</send_true_to>
    <send_false_to>Polo VIP</send_false_to>
    <compare>
      <condition>
        <negated>N</negated>
        <leftvalue>polos</leftvalue>
        <function>=</function>
        <rightvalue/>
        <value>
          <name>constant</name>
          <type>String</type>
          <text>SUMICITY</text>
          <length>-1</length>
          <precision>-1</precision>
          <isnull>N</isnull>
          <mask/>
        </value>
      </condition>
    </compare>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>848</xloc>
      <yloc>144</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Polo VIP</name>
    <type>FilterRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <send_true_to>Registros VIP</send_true_to>
    <send_false_to>Registros MOB</send_false_to>
    <compare>
      <condition>
        <negated>N</negated>
        <leftvalue>polos</leftvalue>
        <function>=</function>
        <rightvalue/>
        <value>
          <name>constant</name>
          <type>String</type>
          <text>VIP</text>
          <length>-1</length>
          <precision>-1</precision>
          <isnull>N</isnull>
          <mask/>
        </value>
      </condition>
    </compare>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>848</xloc>
      <yloc>256</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Registros MOB</name>
    <type>Dummy</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1056</xloc>
      <yloc>352</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Registros SUMICITY</name>
    <type>Dummy</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1056</xloc>
      <yloc>144</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Registros VIP</name>
    <type>Dummy</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1056</xloc>
      <yloc>256</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Select values</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>id_ligacao</name>
      </field>
      <field>
        <name>data_inicial_chamada</name>
      </field>
      <field>
        <name>data_atendimento</name>
      </field>
      <field>
        <name>servico</name>
      </field>
      <field>
        <name>destino_transferencia</name>
      </field>
      <field>
        <name>agente</name>
      </field>
      <field>
        <name>resultado</name>
      </field>
      <field>
        <name>tempo_conversa</name>
      </field>
      <field>
        <name>cpf_cnpj</name>
      </field>
      <field>
        <name>contrato</name>
      </field>
      <field>
        <name>campanha</name>
      </field>
      <field>
        <name>origem</name>
      </field>
      <field>
        <name>destino</name>
      </field>
      <field>
        <name>massiva</name>
      </field>
      <field>
        <name>endereco</name>
      </field>
      <field>
        <name>cidade</name>
      </field>
      <field>
        <name>bairro</name>
      </field>
      <field>
        <name>pergunta_1</name>
      </field>
      <field>
        <name>pergunta_2</name>
      </field>
      <field>
        <name>pergunta_3</name>
      </field>
      <field>
        <name>marca</name>
      </field>
      <field>
        <name>midia</name>
      </field>
      <field>
        <name>tipo</name>
      </field>
      <field>
        <name>polos</name>
      </field>
      <select_unspecified>N</select_unspecified>
      <meta>
        <name>id_ligacao</name>
        <rename>id_ligacao</rename>
        <type>None</type>
        <length>500</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>data_inicial_chamada</name>
        <rename>data_inicial_chamada</rename>
        <type>None</type>
        <length>500</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>data_atendimento</name>
        <rename>data_atendimento</rename>
        <type>None</type>
        <length>500</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>servico</name>
        <rename>servico</rename>
        <type>None</type>
        <length>500</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>destino_transferencia</name>
        <rename>destino_transferencia</rename>
        <type>None</type>
        <length>500</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>agente</name>
        <rename>agente</rename>
        <type>None</type>
        <length>500</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>resultado</name>
        <rename>resultado</rename>
        <type>None</type>
        <length>500</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>tempo_conversa</name>
        <rename>tempo_conversa</rename>
        <type>None</type>
        <length>500</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>cpf_cnpj</name>
        <rename>cpf_cnpj</rename>
        <type>None</type>
        <length>500</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>contrato</name>
        <rename>contrato</rename>
        <type>None</type>
        <length>500</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>campanha</name>
        <rename>campanha</rename>
        <type>None</type>
        <length>500</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>origem</name>
        <rename>origem</rename>
        <type>None</type>
        <length>500</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>destino</name>
        <rename>destino</rename>
        <type>None</type>
        <length>500</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>massiva</name>
        <rename>massiva</rename>
        <type>None</type>
        <length>500</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>endereco</name>
        <rename>endereco</rename>
        <type>None</type>
        <length>500</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>cidade</name>
        <rename>cidade</rename>
        <type>None</type>
        <length>500</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>bairro</name>
        <rename>bairro</rename>
        <type>None</type>
        <length>500</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>pergunta_1</name>
        <rename>pergunta_1</rename>
        <type>None</type>
        <length>500</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>pergunta_2</name>
        <rename>pergunta_2</rename>
        <type>None</type>
        <length>500</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>pergunta_3</name>
        <rename>pergunta_3</rename>
        <type>None</type>
        <length>500</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>marca</name>
        <rename>marca</rename>
        <type>None</type>
        <length>500</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>midia</name>
        <rename>midia</rename>
        <type>None</type>
        <length>8</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>tipo</name>
        <rename>tipo</rename>
        <type>None</type>
        <length>16</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>polos</name>
        <rename>polos</rename>
        <type>None</type>
        <length>16</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>336</xloc>
      <yloc>144</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Sort rows</name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>out</prefix>
    <sort_size>1000000</sort_size>
    <free_memory/>
    <compress>N</compress>
    <compress_variable/>
    <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>polos</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>0</collator_strength>
        <presorted>N</presorted>
      </field>
      <field>
        <name>id_ligacao</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>0</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>592</xloc>
      <yloc>144</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>TMA (MOB)</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>MOB (ODS)</connection>
    <schema>dbo</schema>
    <table>chamadas_recebidas_voz</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>N</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>Y</return_keys>
    <return_field>id</return_field>
    <fields>
      <field>
        <column_name>id_ligacao</column_name>
        <stream_name>id_ligacao</stream_name>
      </field>
      <field>
        <column_name>data_inicial_chamada</column_name>
        <stream_name>data_inicial_chamada</stream_name>
      </field>
      <field>
        <column_name>data_atendimento</column_name>
        <stream_name>data_atendimento</stream_name>
      </field>
      <field>
        <column_name>servico</column_name>
        <stream_name>servico</stream_name>
      </field>
      <field>
        <column_name>destino_transferencia</column_name>
        <stream_name>destino_transferencia</stream_name>
      </field>
      <field>
        <column_name>agente</column_name>
        <stream_name>agente</stream_name>
      </field>
      <field>
        <column_name>resultado</column_name>
        <stream_name>resultado</stream_name>
      </field>
      <field>
        <column_name>tempo_conversa</column_name>
        <stream_name>tempo_conversa</stream_name>
      </field>
      <field>
        <column_name>cpf_cnpj</column_name>
        <stream_name>cpf_cnpj</stream_name>
      </field>
      <field>
        <column_name>contrato</column_name>
        <stream_name>contrato</stream_name>
      </field>
      <field>
        <column_name>campanha</column_name>
        <stream_name>campanha</stream_name>
      </field>
      <field>
        <column_name>origem</column_name>
        <stream_name>origem</stream_name>
      </field>
      <field>
        <column_name>destino</column_name>
        <stream_name>destino</stream_name>
      </field>
      <field>
        <column_name>massiva</column_name>
        <stream_name>massiva</stream_name>
      </field>
      <field>
        <column_name>endereco</column_name>
        <stream_name>endereco</stream_name>
      </field>
      <field>
        <column_name>cidade</column_name>
        <stream_name>cidade</stream_name>
      </field>
      <field>
        <column_name>bairro</column_name>
        <stream_name>bairro</stream_name>
      </field>
      <field>
        <column_name>pergunta_1</column_name>
        <stream_name>pergunta_1</stream_name>
      </field>
      <field>
        <column_name>pergunta_2</column_name>
        <stream_name>pergunta_2</stream_name>
      </field>
      <field>
        <column_name>pergunta_3</column_name>
        <stream_name>pergunta_3</stream_name>
      </field>
      <field>
        <column_name>marca</column_name>
        <stream_name>marca</stream_name>
      </field>
      <field>
        <column_name>midia</column_name>
        <stream_name>midia</stream_name>
      </field>
      <field>
        <column_name>tipo</column_name>
        <stream_name>tipo</stream_name>
      </field>
      <field>
        <column_name>polos</column_name>
        <stream_name>polos</stream_name>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1264</xloc>
      <yloc>352</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>TMA (Sumicity)</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>SUMICITY (ODS)</connection>
    <schema>five9</schema>
    <table>chamadas_recebidas_voz</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>N</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>Y</return_keys>
    <return_field>id</return_field>
    <fields>
      <field>
        <column_name>id_ligacao</column_name>
        <stream_name>id_ligacao</stream_name>
      </field>
      <field>
        <column_name>data_inicial_chamada</column_name>
        <stream_name>data_inicial_chamada</stream_name>
      </field>
      <field>
        <column_name>data_atendimento</column_name>
        <stream_name>data_atendimento</stream_name>
      </field>
      <field>
        <column_name>servico</column_name>
        <stream_name>servico</stream_name>
      </field>
      <field>
        <column_name>destino_transferencia</column_name>
        <stream_name>destino_transferencia</stream_name>
      </field>
      <field>
        <column_name>agente</column_name>
        <stream_name>agente</stream_name>
      </field>
      <field>
        <column_name>resultado</column_name>
        <stream_name>resultado</stream_name>
      </field>
      <field>
        <column_name>tempo_conversa</column_name>
        <stream_name>tempo_conversa</stream_name>
      </field>
      <field>
        <column_name>cpf_cnpj</column_name>
        <stream_name>cpf_cnpj</stream_name>
      </field>
      <field>
        <column_name>contrato</column_name>
        <stream_name>contrato</stream_name>
      </field>
      <field>
        <column_name>campanha</column_name>
        <stream_name>campanha</stream_name>
      </field>
      <field>
        <column_name>origem</column_name>
        <stream_name>origem</stream_name>
      </field>
      <field>
        <column_name>destino</column_name>
        <stream_name>destino</stream_name>
      </field>
      <field>
        <column_name>massiva</column_name>
        <stream_name>massiva</stream_name>
      </field>
      <field>
        <column_name>endereco</column_name>
        <stream_name>endereco</stream_name>
      </field>
      <field>
        <column_name>cidade</column_name>
        <stream_name>cidade</stream_name>
      </field>
      <field>
        <column_name>bairro</column_name>
        <stream_name>bairro</stream_name>
      </field>
      <field>
        <column_name>pergunta_1</column_name>
        <stream_name>pergunta_1</stream_name>
      </field>
      <field>
        <column_name>pergunta_2</column_name>
        <stream_name>pergunta_2</stream_name>
      </field>
      <field>
        <column_name>pergunta_3</column_name>
        <stream_name>pergunta_3</stream_name>
      </field>
      <field>
        <column_name>marca</column_name>
        <stream_name>marca</stream_name>
      </field>
      <field>
        <column_name>midia</column_name>
        <stream_name>midia</stream_name>
      </field>
      <field>
        <column_name>tipo</column_name>
        <stream_name>tipo</stream_name>
      </field>
      <field>
        <column_name>polos</column_name>
        <stream_name>polos</stream_name>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1264</xloc>
      <yloc>144</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>TMA (VIP)</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>VIP (ODS)</connection>
    <schema>dbo</schema>
    <table>chamadas_recebidas_voz</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>N</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>Y</return_keys>
    <return_field>id</return_field>
    <fields>
      <field>
        <column_name>id_ligacao</column_name>
        <stream_name>id_ligacao</stream_name>
      </field>
      <field>
        <column_name>data_inicial_chamada</column_name>
        <stream_name>data_inicial_chamada</stream_name>
      </field>
      <field>
        <column_name>data_atendimento</column_name>
        <stream_name>data_atendimento</stream_name>
      </field>
      <field>
        <column_name>servico</column_name>
        <stream_name>servico</stream_name>
      </field>
      <field>
        <column_name>destino_transferencia</column_name>
        <stream_name>destino_transferencia</stream_name>
      </field>
      <field>
        <column_name>agente</column_name>
        <stream_name>agente</stream_name>
      </field>
      <field>
        <column_name>resultado</column_name>
        <stream_name>resultado</stream_name>
      </field>
      <field>
        <column_name>tempo_conversa</column_name>
        <stream_name>tempo_conversa</stream_name>
      </field>
      <field>
        <column_name>cpf_cnpj</column_name>
        <stream_name>cpf_cnpj</stream_name>
      </field>
      <field>
        <column_name>contrato</column_name>
        <stream_name>contrato</stream_name>
      </field>
      <field>
        <column_name>campanha</column_name>
        <stream_name>campanha</stream_name>
      </field>
      <field>
        <column_name>origem</column_name>
        <stream_name>origem</stream_name>
      </field>
      <field>
        <column_name>destino</column_name>
        <stream_name>destino</stream_name>
      </field>
      <field>
        <column_name>massiva</column_name>
        <stream_name>massiva</stream_name>
      </field>
      <field>
        <column_name>endereco</column_name>
        <stream_name>endereco</stream_name>
      </field>
      <field>
        <column_name>cidade</column_name>
        <stream_name>cidade</stream_name>
      </field>
      <field>
        <column_name>bairro</column_name>
        <stream_name>bairro</stream_name>
      </field>
      <field>
        <column_name>pergunta_1</column_name>
        <stream_name>pergunta_1</stream_name>
      </field>
      <field>
        <column_name>pergunta_2</column_name>
        <stream_name>pergunta_2</stream_name>
      </field>
      <field>
        <column_name>pergunta_3</column_name>
        <stream_name>pergunta_3</stream_name>
      </field>
      <field>
        <column_name>marca</column_name>
        <stream_name>marca</stream_name>
      </field>
      <field>
        <column_name>midia</column_name>
        <stream_name>midia</stream_name>
      </field>
      <field>
        <column_name>tipo</column_name>
        <stream_name>tipo</stream_name>
      </field>
      <field>
        <column_name>polos</column_name>
        <stream_name>polos</stream_name>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1264</xloc>
      <yloc>256</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step_error_handling>
  </step_error_handling>
  <slave-step-copy-partition-distribution>
  </slave-step-copy-partition-distribution>
  <slave_transformation>N</slave_transformation>
  <attributes/>
</transformation>
